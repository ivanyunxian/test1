

/*==================================版本0升级开始======================================*/
DECLARE
    TABLEEXIST NUMBER;                         --用来判断的临时变量
    DBVERSION NUMBER;                          --当前数据库版本号
    UPDATINGVERSION NUMBER;                    --升级版本号
    UPDATETIMESTR  NVARCHAR2(20);              --升级时间
    UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
    UPDATEPERSON  NVARCHAR2(50);               --升级人
    STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
    UPDATINGVERSION:=0;
    UPDATETIMESTR:='2019-09-02 16:49:00';
    UPDATEPERSON:='陶春达';
    UPDATEDESCRIPTION:='添加表：BDC_MRPC.BDC_DBVERSION-抵押登记库版本管理表';
    SELECT COUNT(1) INTO TABLEEXIST FROM DBA_TABLES WHERE TABLE_NAME=UPPER('BDC_DBVERSION') AND OWNER='BDC_MRPC';
    IF TABLEEXIST = 0  THEN
        DBMS_OUTPUT.PUT_LINE('');
        DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

        EXECUTE IMMEDIATE  'CREATE TABLE BDC_MRPC.BDC_DBVERSION  (
            ID                   NVARCHAR2(50),
            VERSION              INTEGER,
            UPDATEDATE           DATE,
            UPDATECONTENT        NVARCHAR2(2000),
            UPDATEPERSION        NVARCHAR2(50),
      executedate        DATE
    )';
        EXECUTE IMMEDIATE  'COMMENT ON TABLE  BDC_MRPC.BDC_DBVERSION IS ''抵押登记库版本管理表''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_DBVERSION.ID IS ''主键ID''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_DBVERSION.VERSION IS ''当前版本号''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_DBVERSION.UPDATEDATE IS ''更新日期''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_DBVERSION.UPDATECONTENT IS ''更新内容''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_DBVERSION.UPDATEPERSION IS ''更新人员'''; 
    EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_DBVERSION.executedate IS ''脚本执行时间'''; 
        EXECUTE IMMEDIATE  'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''00000'',0,SYSDATE,'''',''陶春达'')';
        EXECUTE IMMEDIATE  'COMMIT WORK';

        DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
        DBMS_OUTPUT.PUT_LINE('');
    END IF;
END;
/
/*==================================版本0升级结束======================================*/

/*==================================版本1升级开始======================================*/
DECLARE
    COLUMNEXIST NUMBER;                         --用来判断的临时变量
    DBVERSION NUMBER;                          --当前数据库版本号
    UPDATINGVERSION NUMBER;                    --升级版本号
    UPDATETIMESTR  NVARCHAR2(20);              --升级时间
    UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
    UPDATEPERSON  NVARCHAR2(50);               --升级人
    STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
    UPDATINGVERSION:=1;
    UPDATETIMESTR:='2019-09-02 16:49:00';
    UPDATEPERSON:='陶春达';
    UPDATEDESCRIPTION:='BDC_MRPC.WFI_PROINST 表 审核状态-SHZT 定义修改';
    SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
    IF DBVERSION < UPDATINGVERSION THEN
        DBMS_OUTPUT.PUT_LINE('');
        DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

        SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='WFI_PROINST' AND COLUMN_NAME='SHZT';
          IF COLUMNEXIST = 0  THEN
               EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.WFI_PROINST ADD SHZT NUMBER(10)';
               EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.WFI_PROINST.SHZT IS ''审核状态（-1：未提交，0：待审核，11：审核驳回，-11：提交失败，20：初审通过，30：已登簿）''';
          END IF;
          IF COLUMNEXIST = 1  THEN
               EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.WFI_PROINST.SHZT IS ''审核状态（-1：未提交，0：待审核，11：审核驳回，-11：提交失败，20：初审通过，30：已登簿）''';
          END IF;

        DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
        DBMS_OUTPUT.PUT_LINE('');
        --把当前数据库版本改为本次升级的版本
        STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
        EXECUTE IMMEDIATE STR;
        COMMIT ;
    END IF;
END;
/
/*==================================版本1升级结束======================================*/

/*==================================版本2升级开始======================================*/
DECLARE
  COLUMNEXIST NUMBER;                         --用来判断的临时变量
  DBVERSION NUMBER;                          --当前数据库版本号
  UPDATINGVERSION NUMBER;                    --升级版本号
  UPDATETIMESTR  NVARCHAR2(20);              --升级时间
  UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
  UPDATEPERSON  NVARCHAR2(50);               --升级人
  STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
  UPDATINGVERSION:=2;
  UPDATETIMESTR:='2019-09-03 10:49:00';
  UPDATEPERSON:='包基杰';
  UPDATEDESCRIPTION:='BDC_MRPC.Sys_Log 表 添加RESPONSEDATA返回结果报文，RESULTSTATE接口返回状态字段';
  SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
  IF DBVERSION < UPDATINGVERSION THEN
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

    SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='SYS_LOG' AND COLUMN_NAME='RESPONSEDATA';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.SYS_LOG ADD RESPONSEDATA NCLOB NULL';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.SYS_LOG.RESPONSEDATA IS ''返回结果报文''';
    END IF;

    SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='SYS_LOG' AND COLUMN_NAME='RESULTSTATE';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.SYS_LOG ADD RESULTSTATE NVARCHAR2(10) NULL';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.SYS_LOG.RESULTSTATE IS ''接口返回结果状态''';
    END IF;


    DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
    DBMS_OUTPUT.PUT_LINE('');
    --把当前数据库版本改为本次升级的版本
    STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
    EXECUTE IMMEDIATE STR;
    COMMIT ;
  END IF;
END;
/
/*==================================版本2升级结束======================================*/

/*==================================版本3升级开始======================================*/
DECLARE
  COLUMNEXIST NUMBER;                         --用来判断的临时变量
  DBVERSION NUMBER;                          --当前数据库版本号
  UPDATINGVERSION NUMBER;                    --升级版本号
  UPDATETIMESTR  NVARCHAR2(20);              --升级时间
  UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
  UPDATEPERSON  NVARCHAR2(50);               --升级人
  STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
  UPDATINGVERSION:=3;
  UPDATETIMESTR:='2019-09-03 14:29:00';
  UPDATEPERSON:='陶春达';
  UPDATEDESCRIPTION:='BDC_MRPC.BDC_FSQL 表 添加字段：DYWLX-抵押物类型';
  SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
  IF DBVERSION < UPDATINGVERSION THEN
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

    SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='BDC_FSQL' AND COLUMN_NAME='DYWLX';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.BDC_FSQL ADD DYWLX NVARCHAR2(10)';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.BDC_FSQL.DYWLX IS ''抵押物类型''';
    END IF;

    DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
    DBMS_OUTPUT.PUT_LINE('');
    --把当前数据库版本改为本次升级的版本
    STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
    EXECUTE IMMEDIATE STR;
    COMMIT ;
  END IF;
END;
/
/*==================================版本3升级结束======================================*/

/*==================================版本4升级开始======================================*/
DECLARE
  COLUMNEXIST NUMBER;                         --用来判断的临时变量
  DBVERSION NUMBER;                          --当前数据库版本号
  UPDATINGVERSION NUMBER;                    --升级版本号
  UPDATETIMESTR  NVARCHAR2(20);              --升级时间
  UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
  UPDATEPERSON  NVARCHAR2(50);               --升级人
  STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
  UPDATINGVERSION:=4;
  UPDATETIMESTR:='2019-09-05 10:49:00';
  UPDATEPERSON:='包基杰';
  UPDATEDESCRIPTION:='BDC_MRPC.Sys_Log 表 RESULTSTATE 加长字段';
  SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
  IF DBVERSION < UPDATINGVERSION THEN
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

    SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='SYS_LOG' AND COLUMN_NAME='RESPONSEDATA';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE SYS_LOG MODIFY RESULTSTATE NVARCHAR2(30) DEFAULT NULL;';
    END IF;

    DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
    DBMS_OUTPUT.PUT_LINE('');
    --把当前数据库版本改为本次升级的版本
    STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
    EXECUTE IMMEDIATE STR;
    COMMIT ;
  END IF;
END;
/
/*==================================版本4升级结束======================================*/

/*==================================版本5升级开始======================================*/
DECLARE
  COLUMNEXIST NUMBER;                         --用来判断的临时变量
  DBVERSION NUMBER;                          --当前数据库版本号
  UPDATINGVERSION NUMBER;                    --升级版本号
  UPDATETIMESTR  NVARCHAR2(20);              --升级时间
  UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
  UPDATEPERSON  NVARCHAR2(50);               --升级人
  STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
  UPDATINGVERSION:=5;
  UPDATETIMESTR:='2019-09-10 14:29:00';
  UPDATEPERSON:='包基杰';
  UPDATEDESCRIPTION:='BDC_MRPC.SYS_DEPART 表 TOKEN字段，用于定时获取金融机构提供的回写接口授权token的存储';
  SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
  IF DBVERSION < UPDATINGVERSION THEN
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

    SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='SYS_DEPART' AND COLUMN_NAME='TOKEN';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.SYS_DEPART ADD TOKEN NVARCHAR2(1000)';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.SYS_DEPART.TOKEN IS ''金融机构提供的回写接口授权token''';
    END IF;

    SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='SYS_DEPART' AND COLUMN_NAME='VALIDTIME';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.SYS_DEPART ADD VALIDTIME DATE';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.SYS_DEPART.VALIDTIME IS ''金融机构提供的回写接口授权token有效时间''';
    END IF;

    DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
    DBMS_OUTPUT.PUT_LINE('');
    --把当前数据库版本改为本次升级的版本
    STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
    EXECUTE IMMEDIATE STR;
    COMMIT ;
  END IF;
END;
/
/*==================================版本5升级结束======================================*/

/*==================================版本6升级开始======================================*/
DECLARE
  TABLEEXIST NUMBER;                         --用来判断的临时变量
  DBVERSION NUMBER;                          --当前数据库版本号
  UPDATINGVERSION NUMBER;                    --升级版本号
  UPDATETIMESTR  NVARCHAR2(20);              --升级时间
  UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
  UPDATEPERSON  NVARCHAR2(50);               --升级人
  STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
  UPDATINGVERSION:=6;
  UPDATETIMESTR:='2019-09-10 11:14:00';
  UPDATEPERSON:='陶春达';
  UPDATEDESCRIPTION:='添加表：BDC_MRPC.SYS_DEPART_CONFIG-组织机构配置表';
  SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
  IF DBVERSION < UPDATINGVERSION THEN
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

    SELECT COUNT(1) INTO TABLEEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='SYS_DEPART_CONFIG';
    IF TABLEEXIST = 0  THEN
        EXECUTE IMMEDIATE  'CREATE TABLE BDC_MRPC.SYS_DEPART_CONFIG
                            (
                              ID            NVARCHAR2(50) PRIMARY KEY,
                              DEPT_ID       NVARCHAR2(50) NOT NULL,
                              USERNAME      NVARCHAR2(100),
                              PASSWORD      NVARCHAR2(255),
                              DIVISION_CODE NVARCHAR2(10),
                              NAME          NVARCHAR2(50),
                              VALUE         NVARCHAR2(200),
                              TYPE          NVARCHAR2(5),
                              CREATETIME    DATE,
                              MEMO          NVARCHAR2(500),
                              CONFIG_KEY    VARCHAR2(100)
                            )';
        EXECUTE IMMEDIATE  'COMMENT ON TABLE  BDC_MRPC.SYS_DEPART_CONFIG IS ''组织机构配置表''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.SYS_DEPART_CONFIG.ID IS ''主键ID''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.SYS_DEPART_CONFIG.DEPT_ID IS ''机构ID''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.SYS_DEPART_CONFIG.USERNAME IS ''用户名（机构提供的用户名）''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.SYS_DEPART_CONFIG.PASSWORD IS ''密码（机构提供的密码）''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.SYS_DEPART_CONFIG.DIVISION_CODE IS ''区划代码''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.SYS_DEPART_CONFIG.NAME IS ''名称''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.SYS_DEPART_CONFIG.VALUE IS ''参数值'''; 
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.SYS_DEPART_CONFIG.TYPE IS ''类型'''; 
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.SYS_DEPART_CONFIG.CREATETIME IS ''创建时间'''; 
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.SYS_DEPART_CONFIG.MEMO IS ''备注'''; 
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.SYS_DEPART_CONFIG.CONFIG_KEY IS ''系统参数代码'''; 
        -- Create/Recreate indexes
        EXECUTE IMMEDIATE 'CREATE INDEX IDX_DEPART_CONFIG_DEPT_ID ON BDC_MRPC.SYS_DEPART_CONFIG (DEPT_ID)';
        EXECUTE IMMEDIATE 'CREATE INDEX IDX_DEPART_CONFIG_CONFIG_KEY ON BDC_MRPC.SYS_DEPART_CONFIG (CONFIG_KEY)';
    END IF;

    DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
    DBMS_OUTPUT.PUT_LINE('');
    --把当前数据库版本改为本次升级的版本
    STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
    EXECUTE IMMEDIATE STR;
    COMMIT ;
  END IF;
END;
/
/*==================================版本6升级结束======================================*/

/*==================================版本7升级开始======================================*/
DECLARE
  COLUMNEXIST NUMBER;                         --用来判断的临时变量
  DBVERSION NUMBER;                          --当前数据库版本号
  UPDATINGVERSION NUMBER;                    --升级版本号
  UPDATETIMESTR  NVARCHAR2(20);              --升级时间
  UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
  UPDATEPERSON  NVARCHAR2(50);               --升级人
  STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
  UPDATINGVERSION:=7;
  UPDATETIMESTR:='2019-09-10 15:46:00';
  UPDATEPERSON:='陶春达';
  UPDATEDESCRIPTION:='BDC_MRPC.WFI_PROINST 表添加字段：业务来源-YWLY、机构流水号-ORG_LSH 字段';
  SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
  IF DBVERSION < UPDATINGVERSION THEN
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

    SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='WFI_PROINST' AND COLUMN_NAME='YWLY';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.WFI_PROINST ADD YWLY NVARCHAR2(10)';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.WFI_PROINST.YWLY IS ''业务来源（0：抵押平台，1：金融机构）''';
    END IF;

    SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='WFI_PROINST' AND COLUMN_NAME='ORG_LSH';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.WFI_PROINST ADD ORG_LSH NVARCHAR2(100)';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.WFI_PROINST.ORG_LSH IS ''机构流水号''';
    END IF;

    DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
    DBMS_OUTPUT.PUT_LINE('');
    --把当前数据库版本改为本次升级的版本
    STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
    EXECUTE IMMEDIATE STR;
    COMMIT ;
  END IF;
END;
/
/*==================================版本7升级结束======================================*/

/*==================================版本8升级开始======================================*/
DECLARE
  TABLEEXIST NUMBER;                         --用来判断的临时变量
  DBVERSION NUMBER;                          --当前数据库版本号
  UPDATINGVERSION NUMBER;                    --升级版本号
  UPDATETIMESTR  NVARCHAR2(20);              --升级时间
  UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
  UPDATEPERSON  NVARCHAR2(50);               --升级人
  STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
  UPDATINGVERSION:=8;
  UPDATETIMESTR:='2019-09-10 17:46:00';
  UPDATEPERSON:='包基杰';
  UPDATEDESCRIPTION:='添加机构接口类型的字典值';
  SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
  IF DBVERSION < UPDATINGVERSION THEN
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

    SELECT COUNT(1) INTO TABLEEXIST FROM BDC_MRPC.SYS_DICT WHERE ID='3f4bd74104b475af9c0e01eff301c9a9' ;
    IF TABLEEXIST <1  THEN
      EXECUTE IMMEDIATE 'INSERT INTO SYS_DICT (ID, DICT_NAME, DICT_CODE,DESCRIPTION,DEL_FLAG, CREATE_BY,CREATE_TIME,UPDATE_BY,UPDATE_TIME,TYPE)
         VALUES (''3f4bd74104b475af9c0e01eff301c9a9'',''部门接口类型'',  ''ORGINTERTYPE'', ''部门接口类型'',0,''ADMIN'',TO_DATE(''10-09-2019 16:37:11'', ''DD-MM-YYYY HH24:MI:SS''), NULL, NULL, NULL)';
    END IF;

    SELECT COUNT(1) INTO TABLEEXIST FROM BDC_MRPC.SYS_DICT_ITEM WHERE ID='ee5c543ad0ae52fa4896e3bea3156ba9' ;
    IF TABLEEXIST <1  THEN
      EXECUTE IMMEDIATE 'insert into SYS_DICT_ITEM (ID, DICT_ID,ITEM_TEXT,ITEM_VALUE,DESCRIPTION,SORT_ORDER,STATUS, CREATE_BY,CREATE_TIME,UPDATE_BY,UPDATE_TIME)
                         values (''ee5c543ad0ae52fa4896e3bea3156ba9'',''3f4bd74104b475af9c0e01eff301c9a9'', ''获取金融机构授权信息接口'',''3001'', ''获取金融机构授权信息接口'', 1,1,''admin'',to_date(''10-09-2019 16:37:57'', ''dd-mm-yyyy hh24:mi:ss''), null,null) ';
    END IF;

    SELECT COUNT(1) INTO TABLEEXIST FROM BDC_MRPC.SYS_DICT_ITEM WHERE ID='9fbdede08636f568dcf3f4a58386afce' ;
    IF TABLEEXIST <1  THEN
      EXECUTE IMMEDIATE 'insert into SYS_DICT_ITEM (ID,  DICT_ID,ITEM_TEXT, ITEM_VALUE, DESCRIPTION, SORT_ORDER,STATUS, CREATE_BY, CREATE_TIME, UPDATE_BY, UPDATE_TIME)
                         values (''9fbdede08636f568dcf3f4a58386afce'',''3f4bd74104b475af9c0e01eff301c9a9'',''更新业务状态信息'',''3002'', ''更新业务状态信息'', 2,1,''admin'', to_date(''10-09-2019 16:38:19'', ''dd-mm-yyyy hh24:mi:ss''), ''admin'',to_date(''10-09-2019 16:49:32'', ''dd-mm-yyyy hh24:mi:ss'')) ';
    END IF;

    SELECT COUNT(1) INTO TABLEEXIST FROM BDC_MRPC.SYS_DICT_ITEM WHERE ID='74c7de0143fc7661d451caa0bf9f6db4' ;
    IF TABLEEXIST <1  THEN
      EXECUTE IMMEDIATE 'insert into SYS_DICT_ITEM (ID,DICT_ID,ITEM_TEXT, ITEM_VALUE,  DESCRIPTION, SORT_ORDER, STATUS,CREATE_BY,CREATE_TIME, UPDATE_BY, UPDATE_TIME)
                         values (''74c7de0143fc7661d451caa0bf9f6db4'',''3f4bd74104b475af9c0e01eff301c9a9'',  ''业务登簿结果推送'', ''3003'',''业务登簿结果推送'',3, 1,  ''admin'',  to_date(''10-09-2019 16:38:32'', ''dd-mm-yyyy hh24:mi:ss''),''admin'',to_date(''10-09-2019 16:49:37'', ''dd-mm-yyyy hh24:mi:ss''))';
    END IF;

    SELECT COUNT(1) INTO TABLEEXIST FROM BDC_MRPC.SYS_DICT_ITEM WHERE ID='2527105fc9bb6c8b04ce205c45e8d7c1' ;
    IF TABLEEXIST <1  THEN
      EXECUTE IMMEDIATE 'insert into SYS_DICT_ITEM (ID,DICT_ID,ITEM_TEXT,ITEM_VALUE,DESCRIPTION,SORT_ORDER,STATUS,CREATE_BY,CREATE_TIME,UPDATE_BY,UPDATE_TIME)
                         values (''2527105fc9bb6c8b04ce205c45e8d7c1'',''3f4bd74104b475af9c0e01eff301c9a9'',''电子证照推送'',''3004'',''电子证照推送'',4,1,''admin'',to_date(''10-09-2019 16:38:48'', ''dd-mm-yyyy hh24:mi:ss''),''admin'',to_date(''10-09-2019 16:49:44'', ''dd-mm-yyyy hh24:mi:ss''))';
    END IF;


    DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
    DBMS_OUTPUT.PUT_LINE('');
    --把当前数据库版本改为本次升级的版本
    STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
    EXECUTE IMMEDIATE STR;
    COMMIT ;
  END IF;
END;
/
/*==================================版本8升级结束======================================*/

/*==================================版本9升级开始======================================*/
DECLARE
  COLUMNEXIST NUMBER;                         --用来判断的临时变量
  DBVERSION NUMBER;                          --当前数据库版本号
  UPDATINGVERSION NUMBER;                    --升级版本号
  UPDATETIMESTR  NVARCHAR2(20);              --升级时间
  UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
  UPDATEPERSON  NVARCHAR2(50);               --升级人
  STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
  UPDATINGVERSION:=9;
  UPDATETIMESTR:='2019-09-11 16:16:00';
  UPDATEPERSON:='陶春达';
  UPDATEDESCRIPTION:='BDC_MRPC.WFI_PROINST 表添加字段：回调状态-HDZT';
  SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
  IF DBVERSION < UPDATINGVERSION THEN
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

    SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='WFI_PROINST' AND COLUMN_NAME='HDZT';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.WFI_PROINST ADD HDZT NVARCHAR2(10)';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.WFI_PROINST.HDZT IS ''回调状态（详见枚举ConstValueMrpc.RequestcodeEnum.HDZT）''';
    END IF;

    DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
    DBMS_OUTPUT.PUT_LINE('');
    --把当前数据库版本改为本次升级的版本
    STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
    EXECUTE IMMEDIATE STR;
    COMMIT ;
  END IF;
END;
/
/*==================================版本9升级结束======================================*/

/*==================================版本10升级开始======================================*/
DECLARE
  COLUMNEXIST NUMBER;                         --用来判断的临时变量
  DBVERSION NUMBER;                          --当前数据库版本号
  UPDATINGVERSION NUMBER;                    --升级版本号
  UPDATETIMESTR  NVARCHAR2(20);              --升级时间
  UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
  UPDATEPERSON  NVARCHAR2(50);               --升级人
  STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
  UPDATINGVERSION:=10;
  UPDATETIMESTR:='2019-09-12 09:12:00';
  UPDATEPERSON:='陶春达';
  UPDATEDESCRIPTION:='BDC_MRPC.BDC_ZS 表添加字段：DBJG、YEAR、MONTH、DAY、SJC、SXH';
  SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
  IF DBVERSION < UPDATINGVERSION THEN
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

    SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='BDC_ZS' AND COLUMN_NAME='DBJG';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.BDC_ZS ADD DBJG CLOB';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.BDC_ZS.DBJG IS ''登记系统的登簿结果信息''';
    END IF;
	
	SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='BDC_ZS' AND COLUMN_NAME='YEAR';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.BDC_ZS ADD YEAR NVARCHAR2(10)';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.BDC_ZS.YEAR IS ''证明-年''';
    END IF;
	
	SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='BDC_ZS' AND COLUMN_NAME='MONTH';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.BDC_ZS ADD MONTH NVARCHAR2(10)';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.BDC_ZS.MONTH IS ''证明-月''';
    END IF;
	
	SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='BDC_ZS' AND COLUMN_NAME='DAY';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.BDC_ZS ADD DAY NVARCHAR2(10)';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.BDC_ZS.DAY IS ''证明-日''';
    END IF;
	
	SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='BDC_ZS' AND COLUMN_NAME='SJC';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.BDC_ZS ADD SJC NVARCHAR2(20)';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.BDC_ZS.SJC IS ''证明-区划简称''';
    END IF;
	
	SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='BDC_ZS' AND COLUMN_NAME='SXH';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.BDC_ZS ADD SXH NVARCHAR2(20)';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.BDC_ZS.SXH IS ''证明-不动产权证号-序号''';
    END IF;

    DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
    DBMS_OUTPUT.PUT_LINE('');
    --把当前数据库版本改为本次升级的版本
    STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
    EXECUTE IMMEDIATE STR;
    COMMIT ;
  END IF;
END;
/
/*==================================版本10升级结束======================================*/

/*==================================版本11升级开始======================================*/
DECLARE
  COLUMNEXIST NUMBER;                         --用来判断的临时变量
  DBVERSION NUMBER;                          --当前数据库版本号
  UPDATINGVERSION NUMBER;                    --升级版本号
  UPDATETIMESTR  NVARCHAR2(20);              --升级时间
  UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
  UPDATEPERSON  NVARCHAR2(50);               --升级人
  STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
  UPDATINGVERSION:=11;
  UPDATETIMESTR:='2019-09-16 15:57:00';
  UPDATEPERSON:='陶春达';
  UPDATEDESCRIPTION:='BDC_MRPC.HOUSESHIS 表添加字段：宗地面积-ZDMJ';
  SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
  IF DBVERSION < UPDATINGVERSION THEN
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

    SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='HOUSESHIS' AND COLUMN_NAME='ZDMJ';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.HOUSESHIS ADD ZDMJ NUMBER';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.HOUSESHIS.ZDMJ IS ''宗地面积''';
    END IF;

    DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
    DBMS_OUTPUT.PUT_LINE('');
    --把当前数据库版本改为本次升级的版本
    STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
    EXECUTE IMMEDIATE STR;
    COMMIT ;
  END IF;
END;
/
/*==================================版本11升级结束======================================*/

/*==================================版本12升级开始======================================*/
DECLARE
  COLUMNEXIST NUMBER;                         --用来判断的临时变量
  DBVERSION NUMBER;                          --当前数据库版本号
  UPDATINGVERSION NUMBER;                    --升级版本号
  UPDATETIMESTR  NVARCHAR2(20);              --升级时间
  UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
  UPDATEPERSON  NVARCHAR2(50);               --升级人
  STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
  UPDATINGVERSION:=12;
  UPDATETIMESTR:='2019-09-17 10:00:00';
  UPDATEPERSON:='陶春达';
  UPDATEDESCRIPTION:='BDC_MRPC.BDC_DY 表添加字段：房源接口返回内容-HOUSECLOB';
  SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
  IF DBVERSION < UPDATINGVERSION THEN
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

    SELECT COUNT(1) INTO COLUMNEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='BDC_DY' AND COLUMN_NAME='HOUSECLOB';
    IF COLUMNEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.BDC_DY ADD HOUSECLOB CLOB';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN BDC_MRPC.BDC_DY.HOUSECLOB IS ''房源接口返回内容''';
    END IF;

    DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
    DBMS_OUTPUT.PUT_LINE('');
    --把当前数据库版本改为本次升级的版本
    STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
    EXECUTE IMMEDIATE STR;
    COMMIT ;
  END IF;
END;
/
/*==================================版本12升级结束======================================*/

/*==================================版本13升级开始======================================*/
DECLARE
  TABLEEXIST NUMBER;                         --用来判断的临时变量
  DBVERSION NUMBER;                          --当前数据库版本号
  UPDATINGVERSION NUMBER;                    --升级版本号
  UPDATETIMESTR  NVARCHAR2(20);              --升级时间
  UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
  UPDATEPERSON  NVARCHAR2(50);               --升级人
  STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
  UPDATINGVERSION:=13;
  UPDATETIMESTR:='2019-09-17 17:56:00';
  UPDATEPERSON:='陶春达';
  UPDATEDESCRIPTION:='添加表：BDC_MRPC.BDC_LAST_QL-上一手产权信息';
  SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
  IF DBVERSION < UPDATINGVERSION THEN
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

    SELECT COUNT(1) INTO TABLEEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='BDC_LAST_QL';
    IF TABLEEXIST = 0  THEN
        EXECUTE IMMEDIATE  'CREATE TABLE BDC_MRPC.BDC_LAST_QL
                            (
                              ID            NVARCHAR2(50) PRIMARY KEY,
                              PROLSH       	NVARCHAR2(100) NOT NULL,
							  DYID			NVARCHAR2(100) NOT NULL,
                              DYR         	NVARCHAR2(200),
                              DIVISION_CODE NVARCHAR2(10),
                              DYWLX 		NVARCHAR2(10),
                              ZL         	NVARCHAR2(100),
                              QLQSSJ        DATE,
                              QLJSSJ   		DATE,
                              DYFS          NVARCHAR2(10),
							  DYJE  		NUMBER(38,16),
							  CZFS          NVARCHAR2(10),
							  SFHBZS        NVARCHAR2(10),
							  DYPGJZ        NUMBER(38,16),
							  ZJJZWDYFW     NVARCHAR2(200),
							  ZGZQQDSS      NVARCHAR2(200),
							  ZWR           NVARCHAR2(200),
							  DJYY          NVARCHAR2(1000),
							  FJ            NVARCHAR2(1000),
							  ZXDYYY        NVARCHAR2(1000),
							  ZXFJ          NVARCHAR2(1000)
                            )';
        EXECUTE IMMEDIATE  'COMMENT ON TABLE  BDC_MRPC.BDC_LAST_QL IS ''上一手产权信息表''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.ID IS ''主键ID''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.PROLSH IS ''流水号''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.DYR IS ''抵押人''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.DYWLX IS ''抵押物类型''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.DIVISION_CODE IS ''区划代码''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.ZL IS ''坐落''';
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.QLQSSJ IS ''权利起始时间'''; 
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.QLJSSJ IS ''权利结束时间'''; 
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.DYFS IS ''抵押方式'''; 
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.DYJE IS ''抵押金额'''; 
        EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.CZFS IS ''持证方式'''; 
		EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.SFHBZS IS ''是否合并证书'''; 
		EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.DYPGJZ IS ''抵押评估价值'''; 
		EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.ZJJZWDYFW IS ''在建建筑物抵押范围'''; 
		EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.ZGZQQDSS IS ''最高债权确定事实'''; 
		EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.ZWR IS ''债务人'''; 
		EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.DJYY IS ''登记原因'''; 
		EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.FJ IS ''附记'''; 
		EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.ZXDYYY IS ''注销抵押原因'''; 
		EXECUTE IMMEDIATE  'COMMENT ON COLUMN BDC_MRPC.BDC_LAST_QL.ZXFJ IS ''注销附记'''; 
        -- Create/Recreate indexes
        EXECUTE IMMEDIATE 'CREATE INDEX IDX_BDC_LAST_QL_PROLSH ON BDC_MRPC.BDC_LAST_QL (PROLSH)';
        EXECUTE IMMEDIATE 'CREATE INDEX IDX_BDC_LAST_QL_DYID ON BDC_MRPC.BDC_LAST_QL (DYID)';
    END IF;

    DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
    DBMS_OUTPUT.PUT_LINE('');
    --把当前数据库版本改为本次升级的版本
    STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
    EXECUTE IMMEDIATE STR;
    COMMIT ;
  END IF;
END;
/
/*==================================版本13升级结束======================================*/
/*==================================版本14升级开始======================================*/
DECLARE
  TABLEEXIST NUMBER;                         --用来判断的临时变量
  DBVERSION NUMBER;                          --当前数据库版本号
  UPDATINGVERSION NUMBER;                    --升级版本号
  UPDATETIMESTR  NVARCHAR2(20);              --升级时间
  UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
  UPDATEPERSON  NVARCHAR2(50);               --升级人
  STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
  UPDATINGVERSION:=14;
  UPDATETIMESTR:='2019-09-18 16:15:00';
  UPDATEPERSON:='卢美兰';
  UPDATEDESCRIPTION:='风险防控表：BDC_MRPC.BDC_RISKINFO设置qlid为主键';
  SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
  IF DBVERSION < UPDATINGVERSION THEN
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

    SELECT COUNT(1) INTO TABLEEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='BDC_RISKINFO';
    IF TABLEEXIST = 0  THEN
        EXECUTE IMMEDIATE 'alter table BDC_MRPC.BDC_RISKINFO add primary key(qlid)';
    END IF;

    DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
    DBMS_OUTPUT.PUT_LINE('');
    --把当前数据库版本改为本次升级的版本
    STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
    EXECUTE IMMEDIATE STR;
    COMMIT ;
  END IF;
END;
/
/*==================================版本14升级结束======================================*/
/*==================================版本15升级开始======================================*/
DECLARE
  TABLEEXIST NUMBER;                         --用来判断的临时变量
  DBVERSION NUMBER;                          --当前数据库版本号
  UPDATINGVERSION NUMBER;                    --升级版本号
  UPDATETIMESTR  NVARCHAR2(20);              --升级时间
  UPDATEDESCRIPTION  NVARCHAR2(500);         --升级内容描述
  UPDATEPERSON  NVARCHAR2(50);               --升级人
  STR  VARCHAR2(500);                        --修改版本号语句
BEGIN
  UPDATINGVERSION:=15;
  UPDATETIMESTR:='2019-09-26 16:15:00';
  UPDATEPERSON:='包基杰';
  UPDATEDESCRIPTION:=' SYS_DEPART 添加字段JGDM 机构接口配置代码，对应CoreAPI里配置文件的对应配置，实现不同机构使用不同配置的目的';
  SELECT MAX(VERSION) INTO DBVERSION FROM BDC_MRPC.BDC_DBVERSION;
  IF DBVERSION < UPDATINGVERSION THEN
    DBMS_OUTPUT.PUT_LINE('');
    DBMS_OUTPUT.PUT_LINE('正在从版本'||DBVERSION||'升级到版本'||UPDATINGVERSION||'...');

    SELECT COUNT(1) INTO TABLEEXIST FROM DBA_TAB_COLUMNS WHERE OWNER='BDC_MRPC' AND TABLE_NAME='SYS_DEPART' AND COLUMN_NAME='JGDM';
    IF TABLEEXIST = 0  THEN
      EXECUTE IMMEDIATE 'ALTER TABLE BDC_MRPC.SYS_DEPART ADD JGDM VARCHAR2(50) NULL';
      EXECUTE IMMEDIATE 'COMMENT ON COLUMN SYS_DEPART.JGDM IS ''机构接口配置代码，对应CoreAPI里配置文件的对应配置，实现不同机构使用不同配置的目的''';
    END IF;

    DBMS_OUTPUT.PUT_LINE('从版本'||DBVERSION||'升级到'||UPDATINGVERSION||'完成');
    DBMS_OUTPUT.PUT_LINE('');
    --把当前数据库版本改为本次升级的版本
    STR:= 'INSERT INTO BDC_MRPC.BDC_DBVERSION (ID,VERSION,UPDATEDATE,EXECUTEDATE,UPDATECONTENT,UPDATEPERSION) VALUES(''000'||UPDATINGVERSION||''','||UPDATINGVERSION||',TO_DATE('''||UPDATETIMESTR||''',''YYYY-MM-DD HH24:MI:SS''),SYSDATE,'''||UPDATEDESCRIPTION||''','''||UPDATEPERSON||''')';
    EXECUTE IMMEDIATE STR;
    COMMIT ;
  END IF;
END;
/
/*==================================版本15升级结束======================================*/


-- 查询数据库版本
SELECT VERSION AS 数据库版本,UPDATEDATE AS 修改时间,EXECUTEDATE AS 脚本执行时间,UPDATECONTENT AS  更新说明 ,UPDATEPERSION AS 更新人 FROM BDC_MRPC.BDC_DBVERSION ORDER BY VERSION DESC;

--SELECT * FROM BDC_MRPC.BDC_DBVERSION ORDER BY VERSION DESC FOR UPDATE ;





